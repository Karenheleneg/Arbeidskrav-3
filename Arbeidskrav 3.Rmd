---
title: "Arbeidskrav 3"
author: "Karen Grøndalen"
date: "4 11 2021"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}

library(tidyverse)

set.seed(1)
population <- rnorm(1000000, mean = 1.5, sd = 3)


samp1 <- data.frame(y = sample(population, 8, replace = FALSE))

samp2 <- data.frame(y = sample(population, 40, replace = FALSE))


m1 <- lm(y ~ 1, data = samp1)
m2 <- lm(y ~ 1, data = samp2)



summary(m1)
summary(m2)

```

Spørsmål: 

  1. Forklar estimatet, SE, t-verdi og p-verdi fra regresjonsmodellen (m1 og m2)
    
    

  2. Diskuter hva som bidrar til de ulike resulatatene i de to studiene (m1 og m2)
  
  
  
  3. Hvorfor bruker vi det skyggede området i nedre og øvre hale av t-distribusjonen? (grafen)

```{r}

# Create data frames to store the model estimates
results_8 <- data.frame(estimate = rep(NA, 1000), 
                      se = rep(NA, 1000), 
                      pval = rep(NA, 1000), 
                      n = 8)  

results_40 <- data.frame(estimate = rep(NA, 1000), 
                      se = rep(NA, 1000), 
                      pval = rep(NA, 1000), 
                      n = 40)

# A for loop used to sample 1000 studies, each iteration (i) will draw a new sample
# from the population. 

for(i in 1:1000) {
  
  # Draw a sample 
  samp1 <- data.frame(y = sample(population, 8, replace = FALSE))
  samp2 <- data.frame(y = sample(population, 40, replace = FALSE))

  # Model the data
  m1 <- lm(y ~ 1, data = samp1)
  m2 <- lm(y ~ 1, data = samp2)
  
  # Extract values from the models
  results_8[i, 1] <- coef(summary(m1))[1, 1]
  results_8[i, 2] <- coef(summary(m1))[1, 2]
  results_8[i, 3] <- coef(summary(m1))[1, 4]

  results_40[i, 1] <- coef(summary(m2))[1, 1]
  results_40[i, 2] <- coef(summary(m2))[1, 2]
  results_40[i, 3] <- coef(summary(m2))[1, 4]
  
  
}


# Save the results in a combined data frame

results <- bind_rows(results_8, results_40)

```

Spørsmål:
  4. Beregn standardavviket av 'estimate' variabelen, og gjennomsnittet av SE-variabelen for hver av studienes utvalgsstørrelser (8 og 40). Forklar hvorfor disse tallene er veldig like. Hvordan kan du definere standardfeilen (SE) i lys av disse beregningene? 

  5. Lag et histogram (se eksempelkode) av p-verdiene fra hver studies samplesize. Hvordan tolker du disse histogrammene, og hva forteller de deg om effekten av sample size på statistisk styrke? 

  6. Beregn antall studier fra hver sample size som erklærer en statistisk signifikant effekt (spesifiser en tersken for 'alfa' for ditt signifikansnivå)

  7. Bruk pwr-pakken til å beregne kraften til en t-test med èn prøve, med en effektstørrelse på 1,5/3, ditt spesifiserte signifikansnivå og sample size 8 og 40. Forklar resultatene i lys av simuleringene dine. 

```{r}
population <- rnorm(1000000, mean = 0, sd = 3)


# Create data frames to store the model estimates
results_8 <- data.frame(estimate = rep(NA, 1000), 
                      se = rep(NA, 1000), 
                      pval = rep(NA, 1000), 
                      n = 8)  

results_40 <- data.frame(estimate = rep(NA, 1000), 
                      se = rep(NA, 1000), 
                      pval = rep(NA, 1000), 
                      n = 40)

# A for loop used to sample 1000 studies, each iteration (i) will draw a new sample
# from the population. 

for(i in 1:1000) {
  
  # Draw a sample 
  samp1 <- data.frame(y = sample(population, 8, replace = FALSE))
  samp2 <- data.frame(y = sample(population, 40, replace = FALSE))

  # Model the data
  m1 <- lm(y ~ 1, data = samp1)
  m2 <- lm(y ~ 1, data = samp2)
  
  # Extract values from the models
  results_8[i, 1] <- coef(summary(m1))[1, 1]
  results_8[i, 2] <- coef(summary(m1))[1, 2]
  results_8[i, 3] <- coef(summary(m1))[1, 4]

  results_40[i, 1] <- coef(summary(m2))[1, 1]
  results_40[i, 2] <- coef(summary(m2))[1, 2]
  results_40[i, 3] <- coef(summary(m2))[1, 4]
  
  
}


# Save the results in a combined data frame

results_null <- bind_rows(results_8, results_40)

```

Spørsmål:

  8. Med et signifikansnivå på 5%, hvor mange studier ville gitt deg et "falskt positivt" resultat dersom du repeterte studien mange ganger? 
